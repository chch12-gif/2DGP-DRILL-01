<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/ball.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/ball.py" />
              <option name="originalContent" value="from pico2d import *&#10;import game_world&#10;import game_framework&#10;&#10;PIXEL_PER_METER = (1.0 / 0.03)  # 1pixel = 3cm, 1m = 33.33 pixel&#10;GRAVITY = 9.8  # 중력 가속도 (m/s²)&#10;&#10;class Ball:&#10;    image = None&#10;&#10;    def __init__(self, x = 400, y = 300, throwin_speed = 15, throwin_angle = 45):&#10;        if Ball.image == None:&#10;            Ball.image = load_image('ball21x21.png')&#10;        self.x, self.y = x, y&#10;        self.xv = throwin_speed * math.cos(math.radians(throwin_angle))  # m/s&#10;        self.yv = abs(throwin_speed * math.sin(math.radians(throwin_angle)))   # m/s&#10;        self.stopped = True if throwin_speed == 0.0 else False&#10;&#10;    def draw(self):&#10;        self.image.draw(self.x, self.y)&#10;        draw_rectangle(*self.get_bb())&#10;&#10;    def update(self):&#10;        if self.stopped:&#10;            return&#10;        # 위치 업데이트&#10;        self.x += self.xv * game_framework.frame_time * PIXEL_PER_METER&#10;        self.y += self.yv * game_framework.frame_time * PIXEL_PER_METER&#10;&#10;        # y 축 속도에 중력 가속도 적용&#10;        self.yv -= GRAVITY * game_framework.frame_time  # m/s&#10;&#10;&#10;    def get_bb(self):&#10;        return self.x - 10, self.y - 10, self.x + 10, self.y + 10&#10;&#10;    def handle_collision(self, group, other):&#10;        # 공이 바닥(grass)에 닿거나 소년과 충돌하면 제거&#10;        if group == 'grass:ball' or group == 'boy:ball':&#10;            game_world.remove_object(self)&#10;" />
              <option name="updatedContent" value="from pico2d import *&#10;import game_world&#10;import game_framework&#10;&#10;PIXEL_PER_METER = (1.0 / 0.03)  # 1pixel = 3cm, 1m = 33.33 pixel&#10;GRAVITY = 9.8  # 중력 가속도 (m/s²)&#10;&#10;class Ball:&#10;    image = None&#10;&#10;    def __init__(self, x = 400, y = 300, throwin_speed = 15, throwin_angle = 45):&#10;        if Ball.image == None:&#10;            Ball.image = load_image('ball21x21.png')&#10;        self.x, self.y = x, y&#10;        self.xv = throwin_speed * math.cos(math.radians(throwin_angle))  # m/s&#10;        self.yv = abs(throwin_speed * math.sin(math.radians(throwin_angle)))   # m/s&#10;        self.stopped = True if throwin_speed == 0.0 else False&#10;&#10;    def draw(self):&#10;        self.image.draw(self.x, self.y)&#10;        draw_rectangle(*self.get_bb())&#10;&#10;    def update(self):&#10;        if self.stopped:&#10;            return&#10;        # 위치 업데이트&#10;        self.x += self.xv * game_framework.frame_time * PIXEL_PER_METER&#10;        self.y += self.yv * game_framework.frame_time * PIXEL_PER_METER&#10;&#10;        # y 축 속도에 중력 가속도 적용&#10;        self.yv -= GRAVITY * game_framework.frame_time  # m/s&#10;&#10;&#10;    def get_bb(self):&#10;        return self.x - 10, self.y - 10, self.x + 10, self.y + 10&#10;&#10;    def handle_collision(self, group, other):&#10;        # 공이 바닥(grass)에 닿거나 소년과 충돌하면 제거&#10;        print(f&quot;[DEBUG] Ball.handle_collision: group={group} other={type(other).__name__}&quot;)&#10;        if group == 'grass:ball' or group == 'boy:ball':&#10;            game_world.remove_object(self)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/boy.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/boy.py" />
              <option name="originalContent" value="from pico2d import load_image, get_time, load_font, draw_rectangle&#10;from sdl2 import SDL_KEYDOWN, SDLK_SPACE, SDLK_RIGHT, SDL_KEYUP, SDLK_LEFT&#10;&#10;import game_world&#10;import game_framework&#10;&#10;from ball import Ball&#10;from state_machine import StateMachine&#10;&#10;&#10;def space_down(e): # e is space down ?&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYDOWN and e[1].key == SDLK_SPACE&#10;&#10;time_out = lambda e: e[0] == 'TIMEOUT'&#10;&#10;def right_down(e):&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYDOWN and e[1].key == SDLK_RIGHT&#10;&#10;&#10;def right_up(e):&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYUP and e[1].key == SDLK_RIGHT&#10;&#10;&#10;def left_down(e):&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYDOWN and e[1].key == SDLK_LEFT&#10;&#10;&#10;def left_up(e):&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYUP and e[1].key == SDLK_LEFT&#10;&#10;&#10;&#10;# Boy의 Run Speed 계산&#10;&#10;# Boy Run Speed&#10;PIXEL_PER_METER = (10.0 / 0.3)  # 10 pixel 30 cm&#10;RUN_SPEED_KMPH = 20.0  # Km / Hour&#10;RUN_SPEED_MPM = (RUN_SPEED_KMPH * 1000.0 / 60.0)&#10;RUN_SPEED_MPS = (RUN_SPEED_MPM / 60.0)&#10;RUN_SPEED_PPS = (RUN_SPEED_MPS * PIXEL_PER_METER)&#10;&#10;# Boy Action Speed&#10;TIME_PER_ACTION = 0.5&#10;ACTION_PER_TIME = 1.0 / TIME_PER_ACTION&#10;FRAMES_PER_ACTION = 8&#10;&#10;&#10;&#10;&#10;&#10;&#10;&#10;class Idle:&#10;&#10;    def __init__(self, boy):&#10;        self.boy = boy&#10;&#10;    def enter(self, e):&#10;        self.boy.wait_time = get_time()&#10;        self.boy.dir = 0&#10;&#10;&#10;    def exit(self, e):&#10;        if space_down(e):&#10;            self.boy.fire_ball()&#10;&#10;&#10;    def do(self):&#10;        self.boy.frame = (self.boy.frame + FRAMES_PER_ACTION * ACTION_PER_TIME * game_framework.frame_time) % 8&#10;        if get_time() - self.boy.wait_time &gt; 3:&#10;            self.boy.state_machine.handle_state_event(('TIMEOUT', None))&#10;&#10;    def draw(self):&#10;        if self.boy.face_dir == 1: # right&#10;            self.boy.image.clip_draw(int(self.boy.frame) * 100, 300, 100, 100, self.boy.x, self.boy.y)&#10;        else: # face_dir == -1: # left&#10;            self.boy.image.clip_draw(int(self.boy.frame) * 100, 200, 100, 100, self.boy.x, self.boy.y)&#10;&#10;&#10;class Sleep:&#10;&#10;    def __init__(self, boy):&#10;        self.boy = boy&#10;&#10;    def enter(self, e):&#10;        pass&#10;&#10;    def exit(self, e):&#10;        pass&#10;&#10;    def do(self):&#10;        self.boy.frame = (self.boy.frame + FRAMES_PER_ACTION * ACTION_PER_TIME * game_framework.frame_time) % 8&#10;&#10;&#10;    def handle_event(self, event):&#10;        pass&#10;&#10;    def draw(self):&#10;        if self.boy.face_dir == 1:&#10;            self.boy.image.clip_composite_draw(int(self.boy.frame) * 100, 300, 100, 100, 3.141592/2, '', self.boy.x - 25, self.boy.y - 25, 100, 100)&#10;        else:&#10;            self.boy.image.clip_composite_draw(int(self.boy.frame) * 100, 200, 100, 100, -3.141592/2, '', self.boy.x + 25, self.boy.y - 25, 100, 100)&#10;&#10;&#10;&#10;class Run:&#10;    def __init__(self, boy):&#10;        self.boy = boy&#10;&#10;    def enter(self, e):&#10;        if right_down(e) or left_up(e):&#10;            self.boy.dir = self.boy.face_dir = 1&#10;        elif left_down(e) or right_up(e):&#10;            self.boy.dir = self.boy.face_dir = -1&#10;&#10;    def exit(self, e):&#10;        if space_down(e):&#10;            self.boy.fire_ball()&#10;&#10;    def do(self):&#10;        self.boy.frame = (self.boy.frame + FRAMES_PER_ACTION * ACTION_PER_TIME * game_framework.frame_time) % 8&#10;        self.boy.x += self.boy.dir * RUN_SPEED_PPS * game_framework.frame_time&#10;&#10;    def draw(self):&#10;        if self.boy.face_dir == 1: # right&#10;            self.boy.image.clip_draw(int(self.boy.frame) * 100, 100, 100, 100, self.boy.x, self.boy.y)&#10;        else: # face_dir == -1: # left&#10;            self.boy.image.clip_draw(int(self.boy.frame) * 100, 0, 100, 100, self.boy.x, self.boy.y)&#10;&#10;&#10;&#10;&#10;&#10;&#10;&#10;class Boy:&#10;    def __init__(self):&#10;&#10;        self.ball_count = 10&#10;&#10;        self.font = load_font('ENCR10B.TTF', 16)&#10;&#10;        self.x, self.y = 400, 90&#10;        self.frame = 0&#10;        self.face_dir = 1&#10;        self.dir = 0&#10;        self.image = load_image('animation_sheet.png')&#10;&#10;        self.IDLE = Idle(self)&#10;        self.SLEEP = Sleep(self)&#10;        self.RUN = Run(self)&#10;        self.state_machine = StateMachine(&#10;            self.IDLE,&#10;            {&#10;                self.SLEEP : {space_down: self.IDLE},&#10;                self.IDLE : {space_down: self.IDLE, time_out: self.SLEEP, right_down: self.RUN, left_down: self.RUN, right_up: self.RUN, left_up: self.RUN},&#10;                self.RUN : {space_down: self.RUN, right_up: self.IDLE, left_up: self.IDLE, right_down: self.IDLE, left_down: self.IDLE}&#10;            }&#10;        )&#10;&#10;&#10;&#10;    def update(self):&#10;        self.state_machine.update()&#10;&#10;    def handle_event(self, event):&#10;        self.state_machine.handle_state_event(('INPUT', event))&#10;        pass&#10;&#10;    def draw(self):&#10;        self.state_machine.draw()&#10;        self.font.draw(self.x-10, self.y + 50, f'{self.ball_count:02d}', (255, 255, 0))&#10;&#10;    def fire_ball(self):&#10;        if self.ball_count &gt; 0:&#10;            self.ball_count -= 1&#10;            ball = Ball(self.x+self.face_dir*40, self.y+100, self.face_dir * 15)&#10;            game_world.add_object(ball, 1)&#10;            game_world.add_collision_pairs('grass:ball', None, ball)&#10;            game_world.add_collision_pairs('boy:ball', None, ball)&#10;&#10;    def get_bb(self):&#10;        return self.x - 50, self.y - 50, self.x + 50, self.y + 50&#10;    def draw(self):&#10;        self.state_machine.draw()&#10;        self.font.draw(self.x-10, self.y + 50, f'{self.ball_count:02d}', (255, 255, 0))&#10;        draw_rectangle(*self.get_bb())&#10;&#10;    def handle_collision(self, group, other):&#10;        if group == 'boy:ball':&#10;            self.ball_count += 1&#10;" />
              <option name="updatedContent" value="from pico2d import load_image, get_time, load_font, draw_rectangle&#10;from sdl2 import SDL_KEYDOWN, SDLK_SPACE, SDLK_RIGHT, SDL_KEYUP, SDLK_LEFT&#10;&#10;import game_world&#10;import game_framework&#10;&#10;from ball import Ball&#10;from state_machine import StateMachine&#10;&#10;&#10;def space_down(e): # e is space down ?&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYDOWN and e[1].key == SDLK_SPACE&#10;&#10;time_out = lambda e: e[0] == 'TIMEOUT'&#10;&#10;def right_down(e):&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYDOWN and e[1].key == SDLK_RIGHT&#10;&#10;&#10;def right_up(e):&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYUP and e[1].key == SDLK_RIGHT&#10;&#10;&#10;def left_down(e):&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYDOWN and e[1].key == SDLK_LEFT&#10;&#10;&#10;def left_up(e):&#10;    return e[0] == 'INPUT' and e[1].type == SDL_KEYUP and e[1].key == SDLK_LEFT&#10;&#10;&#10;&#10;# Boy의 Run Speed 계산&#10;&#10;# Boy Run Speed&#10;PIXEL_PER_METER = (10.0 / 0.3)  # 10 pixel 30 cm&#10;RUN_SPEED_KMPH = 20.0  # Km / Hour&#10;RUN_SPEED_MPM = (RUN_SPEED_KMPH * 1000.0 / 60.0)&#10;RUN_SPEED_MPS = (RUN_SPEED_MPM / 60.0)&#10;RUN_SPEED_PPS = (RUN_SPEED_MPS * PIXEL_PER_METER)&#10;&#10;# Boy Action Speed&#10;TIME_PER_ACTION = 0.5&#10;ACTION_PER_TIME = 1.0 / TIME_PER_ACTION&#10;FRAMES_PER_ACTION = 8&#10;&#10;&#10;&#10;&#10;&#10;&#10;&#10;class Idle:&#10;&#10;    def __init__(self, boy):&#10;        self.boy = boy&#10;&#10;    def enter(self, e):&#10;        self.boy.wait_time = get_time()&#10;        self.boy.dir = 0&#10;&#10;&#10;    def exit(self, e):&#10;        if space_down(e):&#10;            self.boy.fire_ball()&#10;&#10;&#10;    def do(self):&#10;        self.boy.frame = (self.boy.frame + FRAMES_PER_ACTION * ACTION_PER_TIME * game_framework.frame_time) % 8&#10;        if get_time() - self.boy.wait_time &gt; 3:&#10;            self.boy.state_machine.handle_state_event(('TIMEOUT', None))&#10;&#10;    def draw(self):&#10;        if self.boy.face_dir == 1: # right&#10;            self.boy.image.clip_draw(int(self.boy.frame) * 100, 300, 100, 100, self.boy.x, self.boy.y)&#10;        else: # face_dir == -1: # left&#10;            self.boy.image.clip_draw(int(self.boy.frame) * 100, 200, 100, 100, self.boy.x, self.boy.y)&#10;&#10;&#10;class Sleep:&#10;&#10;    def __init__(self, boy):&#10;        self.boy = boy&#10;&#10;    def enter(self, e):&#10;        pass&#10;&#10;    def exit(self, e):&#10;        pass&#10;&#10;    def do(self):&#10;        self.boy.frame = (self.boy.frame + FRAMES_PER_ACTION * ACTION_PER_TIME * game_framework.frame_time) % 8&#10;&#10;&#10;    def handle_event(self, event):&#10;        pass&#10;&#10;    def draw(self):&#10;        if self.boy.face_dir == 1:&#10;            self.boy.image.clip_composite_draw(int(self.boy.frame) * 100, 300, 100, 100, 3.141592/2, '', self.boy.x - 25, self.boy.y - 25, 100, 100)&#10;        else:&#10;            self.boy.image.clip_composite_draw(int(self.boy.frame) * 100, 200, 100, 100, -3.141592/2, '', self.boy.x + 25, self.boy.y - 25, 100, 100)&#10;&#10;&#10;&#10;class Run:&#10;    def __init__(self, boy):&#10;        self.boy = boy&#10;&#10;    def enter(self, e):&#10;        if right_down(e) or left_up(e):&#10;            self.boy.dir = self.boy.face_dir = 1&#10;        elif left_down(e) or right_up(e):&#10;            self.boy.dir = self.boy.face_dir = -1&#10;&#10;    def exit(self, e):&#10;        if space_down(e):&#10;            self.boy.fire_ball()&#10;&#10;    def do(self):&#10;        self.boy.frame = (self.boy.frame + FRAMES_PER_ACTION * ACTION_PER_TIME * game_framework.frame_time) % 8&#10;        self.boy.x += self.boy.dir * RUN_SPEED_PPS * game_framework.frame_time&#10;&#10;    def draw(self):&#10;        if self.boy.face_dir == 1: # right&#10;            self.boy.image.clip_draw(int(self.boy.frame) * 100, 100, 100, 100, self.boy.x, self.boy.y)&#10;        else: # face_dir == -1: # left&#10;            self.boy.image.clip_draw(int(self.boy.frame) * 100, 0, 100, 100, self.boy.x, self.boy.y)&#10;&#10;&#10;&#10;&#10;&#10;&#10;&#10;class Boy:&#10;    def __init__(self):&#10;&#10;        self.ball_count = 10&#10;&#10;        self.font = load_font('ENCR10B.TTF', 16)&#10;&#10;        self.x, self.y = 400, 90&#10;        self.frame = 0&#10;        self.face_dir = 1&#10;        self.dir = 0&#10;        self.image = load_image('animation_sheet.png')&#10;&#10;        self.IDLE = Idle(self)&#10;        self.SLEEP = Sleep(self)&#10;        self.RUN = Run(self)&#10;        self.state_machine = StateMachine(&#10;            self.IDLE,&#10;            {&#10;                self.SLEEP : {space_down: self.IDLE},&#10;                self.IDLE : {space_down: self.IDLE, time_out: self.SLEEP, right_down: self.RUN, left_down: self.RUN, right_up: self.RUN, left_up: self.RUN},&#10;                self.RUN : {space_down: self.RUN, right_up: self.IDLE, left_up: self.IDLE, right_down: self.IDLE, left_down: self.IDLE}&#10;            }&#10;        )&#10;&#10;&#10;&#10;    def update(self):&#10;        self.state_machine.update()&#10;&#10;    def handle_event(self, event):&#10;        self.state_machine.handle_state_event(('INPUT', event))&#10;        pass&#10;&#10;    def draw(self):&#10;        self.state_machine.draw()&#10;        self.font.draw(self.x-10, self.y + 50, f'{self.ball_count:02d}', (255, 255, 0))&#10;&#10;    def fire_ball(self):&#10;        if self.ball_count &gt; 0:&#10;            self.ball_count -= 1&#10;            ball = Ball(self.x+self.face_dir*40, self.y+100, self.face_dir * 15)&#10;            game_world.add_object(ball, 1)&#10;            game_world.add_collision_pairs('grass:ball', None, ball)&#10;            game_world.add_collision_pairs('boy:ball', None, ball)&#10;            print(f&quot;[DEBUG] Boy.fire_ball: created ball at ({ball.x:.1f},{ball.y:.1f}) xv={ball.xv:.2f} yv={ball.yv:.2f}&quot;)&#10;&#10;    def get_bb(self):&#10;        return self.x - 50, self.y - 50, self.x + 50, self.y + 50&#10;    def draw(self):&#10;        self.state_machine.draw()&#10;        self.font.draw(self.x-10, self.y + 50, f'{self.ball_count:02d}', (255, 255, 0))&#10;        draw_rectangle(*self.get_bb())&#10;&#10;    def handle_collision(self, group, other):&#10;        if group == 'boy:ball':&#10;            self.ball_count += 1&#10;            print(f&quot;[DEBUG] Boy.handle_collision: picked up ball from {type(other).__name__}&quot;)" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>